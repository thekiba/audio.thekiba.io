<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
    <link rel="stylesheet" href="./src/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="./src/bootstrap/css/bootstrap-responsive.min.css"/>

    <script src="http://vk.com/js/api/xd_connection.js?2" type="text/javascript"></script>

    <script type="text/javascript" src="./src/audio.js">

    </script>
    <script type="text/javascript" src="./src/bootstrap/js/bootstrap.min.js"></script>
</head>
<body>

</body>
<script type="text/javascript">
    VK.init(function () {
        audio.get_all_audio(VK.id, function (items) {
            var items_no_sort = audio.clone(items);
            var items_sort = audio.clone(items);
            audio.sort_audio(items_sort, 'artist', 'title');

            var reorder = [];

            for (var i = 0; i < items_no_sort.length; i++) {
                if (items_no_sort[i]['aid'] != items_sort[i]['aid']) {
                    var after_aid = 0; // После какого элемента поставить аудио

                    for (var j = 0; j < items_sort.length; j++) {
                        if (items_sort[j]['aid'] == items_no_sort[i]['aid']) {
                            if(typeof items_sort[j-1] == 'undefined')
                            {
                                after_aid = 0;
                            } else {
                                after_aid = items_sort[j-1]['aid'];
                            }
                            break;
                        }
                    }

                    var temp = items_no_sort[i];
                    for(var j = i; j < items.length; j++)
                    {
                        items_no_sort[i] = items_no_sort[i+1];
                    }

                    reorder[reorder.length] = {aid: items_no_sort[i]['aid'], after: after_aid};

                    i--;
                }
            }

            audio.reorder(reorder, 0, count, function () {
                console.log(reorder);
                console.log('done');
                document.write('Done!');
            });
        });
    });
</script>
</html>